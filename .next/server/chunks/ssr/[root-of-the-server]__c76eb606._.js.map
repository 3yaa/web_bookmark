{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/rye/Personal/bookmark/web_bookmark/app/auth/AuthContext.tsx"],"sourcesContent":["\"use client\";\nimport {\n  ReactNode,\n  useState,\n  createContext,\n  useEffect,\n  useCallback,\n  useRef,\n} from \"react\";\nimport { usePathname } from \"next/navigation\";\n\ninterface AuthContextType {\n  authToken: string | null;\n  setAuthToken: (authToken: string | null) => void;\n  isAuthenticated: boolean;\n  isRefreshing: boolean;\n  isInitializing: boolean;\n  refreshToken: () => Promise<string | null>;\n}\n\n// auth context\nexport const AuthTokenContext = createContext<AuthContextType | null>(null);\n\n// Auth Provider Component\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [authToken, setAuthToken] = useState<string | null>(null);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const [isInitializing, setIsInitializing] = useState(true);\n  const refreshTimerRef = useRef<NodeJS.Timeout | null>(null);\n  const refreshPromiseRef = useRef<Promise<string | null> | null>(null);\n  const pathname = usePathname();\n  const isAuthPage = pathname === \"/login\" || pathname === \"/register\";\n\n  // parse jwt to find expiration time\n  const parseTokenExpiry = useCallback((token: string): number | null => {\n    try {\n      const payload = JSON.parse(atob(token.split(\".\")[1]));\n      return payload.exp * 1000; //miliseconds -- exp: unix timestamp in seconds\n    } catch (e) {\n      console.error(\"failed to parse token: \", e);\n      return null;\n    }\n  }, []);\n\n  // refreshes token 1 min before expiration\n  const scheduleNextRefresh = useCallback(\n    (token: string, refreshFunc: () => Promise<string | null>) => {\n      if (refreshTimerRef.current) {\n        clearTimeout(refreshTimerRef.current);\n      }\n      //\n      const expiryTime = parseTokenExpiry(token);\n      if (!expiryTime) return;\n      //schedules to call the refreshfunc after refreshtime\n      const refreshTime = expiryTime - Date.now() - 1 * 60 * 1000;\n      if (refreshTime > 0) {\n        refreshTimerRef.current = setTimeout(() => {\n          refreshFunc();\n        }, refreshTime);\n      }\n    },\n    [parseTokenExpiry]\n  );\n\n  // call server for new auth token\n  const refreshToken = useCallback(async (): Promise<string | null> => {\n    if (refreshPromiseRef.current) {\n      return refreshPromiseRef.current;\n    }\n    setIsRefreshing(true);\n    // make call\n    const refreshPromise = (async () => {\n      try {\n        const response = await fetch(`/api/auth/refresh`, {\n          credentials: \"include\",\n        });\n        if (!response.ok) {\n          if (response.status === 401 || response.status === 403) {\n            setAuthToken(null);\n            throw new Error(\"session expired\");\n          }\n          throw new Error(\"token refresh failed\");\n        }\n        //\n        const data = await response.json();\n        const newToken = data.accessToken;\n        //\n        setAuthToken(newToken);\n        scheduleNextRefresh(newToken, refreshToken);\n        return newToken;\n      } catch (e) {\n        console.error(\"Token refresh failed: \", e);\n        setAuthToken(null);\n        throw e;\n      } finally {\n        setIsRefreshing(false);\n        refreshPromiseRef.current = null;\n      }\n    })();\n\n    refreshPromiseRef.current = refreshPromise;\n    return refreshPromise;\n  }, [scheduleNextRefresh]);\n\n  // on mount get token\n  useEffect(() => {\n    const initializeAuth = async () => {\n      if (isAuthPage) {\n        setIsInitializing(false);\n        return;\n      }\n      try {\n        await refreshToken();\n      } catch (e) {\n        console.log(\"No valid session found: \", e);\n      } finally {\n        setIsInitializing(false);\n      }\n    };\n    //\n    initializeAuth();\n    //\n    return () => {\n      if (refreshTimerRef.current) {\n        clearTimeout(refreshTimerRef.current);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // handles case when timer goes over bc went to another site\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.visibilityState === \"visible\" && authToken) {\n        const expiryTime = parseTokenExpiry(authToken);\n        if (expiryTime && Date.now() >= expiryTime - 5 * 60 * 1000) {\n          refreshToken();\n        }\n      }\n    };\n    //\n    document.addEventListener(\"visibilitychange\", handleVisibilityChange);\n    return () => {\n      document.removeEventListener(\"visibilitychange\", handleVisibilityChange);\n    };\n  }, [authToken, refreshToken, parseTokenExpiry]);\n\n  // sets token with the scheduler\n  const setAuthTokenWithScheduling = useCallback(\n    (token: string | null) => {\n      setAuthToken(token);\n      if (token) {\n        scheduleNextRefresh(token, refreshToken);\n      } else if (refreshTimerRef.current) {\n        clearTimeout(refreshTimerRef.current);\n      }\n    },\n    [scheduleNextRefresh, refreshToken]\n  );\n\n  const value = {\n    authToken,\n    setAuthToken: setAuthTokenWithScheduling,\n    isAuthenticated: !!authToken,\n    isRefreshing,\n    isInitializing,\n    refreshToken,\n  };\n\n  return (\n    <AuthTokenContext.Provider value={value}>\n      {children}\n    </AuthTokenContext.Provider>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///home/rye/Personal/bookmark/web_bookmark/hooks/useAuth.ts"],"sourcesContent":["import { AuthTokenContext } from \"@/app/auth/AuthContext\";\nimport { useContext } from \"react\";\n\nexport function useAuth() {\n  const context = useContext(AuthTokenContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within an authprovider\");\n  }\n  return context;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,mNAAU,EAAC,+IAAgB;IAC3C,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 215, "column": 0}, "map": {"version":3,"sources":["file:///home/rye/Personal/bookmark/web_bookmark/hooks/useLogout.ts"],"sourcesContent":["import { useAuth } from \"@/hooks/useAuth\";\nimport { useRouter } from \"next/navigation\";\nimport { useState } from \"react\";\n\nexport function useLogout() {\n  const { setAuthToken } = useAuth();\n  const [isLoggingOut, setIsLoggingOut] = useState(false);\n  const router = useRouter();\n\n  const logout = async () => {\n    setIsLoggingOut(true);\n\n    try {\n      const response = await fetch(`/api/auth/logout`, {\n        method: \"GET\",\n        credentials: \"include\",\n      });\n\n      if (!response.ok && response.status !== 204) {\n        throw new Error(`Logout failed`);\n      }\n\n      setAuthToken(null);\n      router.push(\"/\");\n    } catch (error) {\n      console.log(\"Logout failed: \", error);\n      throw error; // Re-throw so caller can handle\n    } finally {\n      setIsLoggingOut(false);\n    }\n  };\n\n  return { logout, isLoggingOut };\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,SAAS;IACd,MAAM,EAAE,YAAY,EAAE,GAAG,IAAA,2HAAO;IAChC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,iNAAQ,EAAC;IACjD,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,SAAS;QACb,gBAAgB;QAEhB,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,CAAC,gBAAgB,CAAC,EAAE;gBAC/C,QAAQ;gBACR,aAAa;YACf;YAEA,IAAI,CAAC,SAAS,EAAE,IAAI,SAAS,MAAM,KAAK,KAAK;gBAC3C,MAAM,IAAI,MAAM,CAAC,aAAa,CAAC;YACjC;YAEA,aAAa;YACb,OAAO,IAAI,CAAC;QACd,EAAE,OAAO,OAAO;YACd,QAAQ,GAAG,CAAC,mBAAmB;YAC/B,MAAM,OAAO,gCAAgC;QAC/C,SAAU;YACR,gBAAgB;QAClB;IACF;IAEA,OAAO;QAAE;QAAQ;IAAa;AAChC","debugId":null}},
    {"offset": {"line": 257, "column": 0}, "map": {"version":3,"sources":["file:///home/rye/Personal/bookmark/web_bookmark/app/components/NavMenu.tsx"],"sourcesContent":["\"use client\";\nimport {\n  Menu,\n  Home,\n  Video,\n  Tv,\n  Book,\n  Gamepad2,\n  X,\n  ChevronRight,\n  LogIn,\n  LogOut,\n  type LucideIcon,\n} from \"lucide-react\";\nimport { useState, useRef, useEffect } from \"react\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { useRouter } from \"next/navigation\";\nimport Link from \"next/link\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useLogout } from \"@/hooks/useLogout\";\n\ntype NavigationItem = {\n  label: string;\n  icon: LucideIcon;\n  path: string;\n};\n\ntype ActionItem = {\n  label: string;\n  icon: LucideIcon;\n  action: () => Promise<void>;\n  isAction: true;\n};\n\ntype MenuItem = NavigationItem | ActionItem;\n\nconst allMenuItems: NavigationItem[] = [\n  { label: \"Movies\", icon: Video, path: \"/movies\" },\n  { label: \"Shows\", icon: Tv, path: \"/shows\" },\n  { label: \"Books\", icon: Book, path: \"/books\" },\n  { label: \"Games\", icon: Gamepad2, path: \"/games\" },\n  { label: \"Home\", icon: Home, path: \"/\" },\n];\n\nexport function NavMenu() {\n  const [isOpen, setIsOpen] = useState(false);\n  const menuRef = useRef<HTMLDivElement>(null);\n  const router = useRouter();\n  const { isAuthenticated } = useAuth();\n  const { logout, isLoggingOut } = useLogout();\n\n  // Determine which menu items to show based on path and auth status\n  const getMenuItems = (): MenuItem[] => {\n    const authItem: MenuItem = isAuthenticated\n      ? {\n          label: isLoggingOut ? \"Logging out...\" : \"Logout\",\n          icon: LogOut,\n          action: logout,\n          isAction: true,\n        }\n      : { label: \"Login\", icon: LogIn, path: \"/login\" };\n    return [...allMenuItems, authItem];\n  };\n\n  const menuItems = getMenuItems();\n\n  // Close menu when clicking outside\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (\n        menuRef.current &&\n        event.target instanceof Node &&\n        !menuRef.current.contains(event.target)\n      ) {\n        setIsOpen(false);\n      }\n    }\n\n    if (isOpen) {\n      document.addEventListener(\"mousedown\", handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [isOpen]);\n\n  useEffect(() => {\n    function handleEscape(event: KeyboardEvent) {\n      switch (event.key) {\n        case \"Escape\":\n          if (isOpen) {\n            setIsOpen(false);\n          } else {\n            setIsOpen(true);\n          }\n          return;\n        case \"5\":\n          if (isOpen) {\n            router.push(\"/\");\n            setIsOpen(false);\n          }\n          return;\n        case \"1\":\n          if (isOpen) {\n            router.push(\"/movies\");\n            setIsOpen(false);\n          }\n          return;\n        case \"2\":\n          if (isOpen) {\n            router.push(\"/shows\");\n            setIsOpen(false);\n          }\n          return;\n        case \"3\":\n          if (isOpen) {\n            router.push(\"/books\");\n            setIsOpen(false);\n          }\n          return;\n        case \"4\":\n          if (isOpen) {\n            router.push(\"/games\");\n            setIsOpen(false);\n          }\n          return;\n        default:\n          return;\n      }\n    }\n\n    document.addEventListener(\"keydown\", handleEscape);\n\n    return () => {\n      document.removeEventListener(\"keydown\", handleEscape);\n    };\n  }, [isOpen, router]);\n\n  return (\n    <div\n      ref={menuRef}\n      className=\"fixed bottom-8 left-8 z-10 flex flex-col items-start\"\n      onClick={() => setIsOpen(!isOpen)}\n    >\n      {/* Dropdown */}\n      <AnimatePresence>\n        {isOpen && (\n          <motion.div\n            initial={{ opacity: 0, y: 6, scale: 0.97 }}\n            animate={{ opacity: 1, y: 0, scale: 1 }}\n            exit={{ opacity: 0, y: 6, scale: 0.97 }}\n            transition={{ type: \"spring\", stiffness: 240, damping: 28 }}\n            className=\"mb-3 w-40 rounded-xl bg-gradient-to-bl from-zinc-transparent via-zinc-800/20 to-zinc-800/60 backdrop-blur-xl \n                       border border-zinc-800/50 ring-1 ring-zinc-800/50 overflow-hidden\"\n          >\n            <ul className=\"flex flex-col-reverse\">\n              {menuItems.reverse().map((item, i) => {\n                const Icon = item.icon;\n\n                // Handle logout action item\n                if (\"isAction\" in item && item.isAction) {\n                  return (\n                    <motion.li\n                      key={item.label}\n                      initial={{ opacity: 0, x: -10 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      exit={{ opacity: 0, x: -10 }}\n                      transition={{ delay: i * 0.05, duration: 0.1 }}\n                    >\n                      <button\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setIsOpen(false);\n                          item.action();\n                        }}\n                        disabled={isLoggingOut}\n                        className=\"w-full flex items-center justify-between pl-4.5 pr-5 py-3\n                                   text-sm font-medium text-zinc-300 \n                                   hover:text-red-400 hover:bg-gradient-to-r from-red-500/8\n                                   transition-all group hover:cursor-pointer\n                                   disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <Icon className=\"w-4.5 h-4.5 opacity-70 group-hover:opacity-100 transition-opacity\" />\n                          <span className=\"tracking-wide truncate\">\n                            {item.label}\n                          </span>\n                        </div>\n                        <ChevronRight\n                          className=\"w-4 h-4 opacity-0 group-hover:opacity-100 \n                                                 translate-x-[-4px] group-hover:translate-x-0 \n                                                 transition-all duration-200\"\n                        />\n                      </button>\n                    </motion.li>\n                  );\n                }\n\n                // Handle regular navigation items\n                if (\"path\" in item) {\n                  return (\n                    <motion.li\n                      key={item.label}\n                      initial={{ opacity: 0, x: -10 }}\n                      animate={{ opacity: 1, x: 0 }}\n                      exit={{ opacity: 0, x: -10 }}\n                      transition={{ delay: i * 0.05, duration: 0.1 }}\n                    >\n                      <Link\n                        href={item.path}\n                        onClick={(e) => {\n                          e.stopPropagation();\n                          setIsOpen(false);\n                        }}\n                        className=\"w-full flex items-center justify-between pl-4.5 pr-5 py-3\n                                   text-sm font-medium text-zinc-300 \n                                   hover:text-emerald-500 hover:bg-gradient-to-r from-emerald-500/8\n                                   transition-all group hover:cursor-pointer\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <Icon className=\"w-4.5 h-4.5 opacity-70 group-hover:opacity-100 transition-opacity\" />\n                          <span className=\"tracking-wide truncate\">\n                            {item.label}\n                          </span>\n                        </div>\n                        <ChevronRight\n                          className=\"w-4 h-4 opacity-0 group-hover:opacity-100 \n                                                 translate-x-[-4px] group-hover:translate-x-0 \n                                                 transition-all duration-200\"\n                        />\n                      </Link>\n                    </motion.li>\n                  );\n                }\n\n                return null;\n              })}\n            </ul>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* MAIN BUTTON */}\n      <button\n        className={`flex items-center justify-center w-14 h-14 rounded-full \n          border border-zinc-900/50 \n          bg-gradient-to-bl from-zinc-transparent to-zinc-800/60 \n          hover:bg-graident-to-bl hover:from-zinc-800/60 hover:to-transparent\n          backdrop-blur-xl \n          shadow-md hover:scale-105 active:scale-95 \n          transition-all duration-200 relative z-10 hover:cursor-pointer focus:outline-none`}\n      >\n        {isOpen ? (\n          <X className=\"w-5 h-5 text-zinc-300\" />\n        ) : (\n          <Menu className=\"w-5 h-5 text-zinc-300\" />\n        )}\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 634, "column": 0}, "map": {"version":3,"sources":["file:///home/rye/Personal/bookmark/web_bookmark/app/components/ui/Loading.tsx"],"sourcesContent":["interface LoadingProps {\n  customStyle: string; //border\n  customBg?: string;\n  text?: string;\n}\n\nexport function Loading({\n  customBg = \"bg-[#121212]\",\n  customStyle,\n  text,\n}: LoadingProps) {\n  return (\n    <div\n      className={`absolute inset-0 ${customBg} rounded-2xl flex items-center justify-center z-20`}\n    >\n      <div className=\"flex flex-col items-center gap-3\">\n        <div\n          className={`animate-spin rounded-full border-b-2 ${customStyle}`}\n        ></div>\n        <span className=\"text-zinc-300 text-sm\">{text}</span>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAMO,SAAS,QAAQ,EACtB,WAAW,cAAc,EACzB,WAAW,EACX,IAAI,EACS;IACb,qBACE,8OAAC;QACC,WAAW,CAAC,iBAAiB,EAAE,SAAS,kDAAkD,CAAC;kBAE3F,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBACC,WAAW,CAAC,qCAAqC,EAAE,aAAa;;;;;;8BAElE,8OAAC;oBAAK,WAAU;8BAAyB;;;;;;;;;;;;;;;;;AAIjD","debugId":null}},
    {"offset": {"line": 677, "column": 0}, "map": {"version":3,"sources":["file:///home/rye/Personal/bookmark/web_bookmark/app/auth/RouteGuard.tsx"],"sourcesContent":["\"use client\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useRouter, usePathname } from \"next/navigation\";\nimport { useEffect, ReactNode } from \"react\";\nimport { Loading } from \"../components/ui/Loading\";\n\ninterface RouteGuardProps {\n  children: ReactNode;\n}\n\n// Define which routes require authentication\nconst PROTECTED_ROUTES = [\"/movies\", \"/shows\", \"/books\", \"/games\"];\nconst PUBLIC_ROUTES = [\"/login\", \"/register\"];\n\nexport function RouteGuard({ children }: RouteGuardProps) {\n  const { isAuthenticated, isRefreshing, isInitializing } = useAuth();\n  const router = useRouter();\n  const pathname = usePathname() || \"/\";\n\n  // Check if current path is public\n  const isPublicRoute = PUBLIC_ROUTES.some((route) =>\n    pathname.startsWith(route)\n  );\n\n  // Check if current path is protected\n  const isProtectedRoute = PROTECTED_ROUTES.some((route) =>\n    pathname.startsWith(route)\n  );\n\n  // Home page is protected unless explicitly public\n  const isHomePageProtected = pathname === \"/\" && !isPublicRoute;\n\n  // Redirect logic\n  useEffect(() => {\n    if (isInitializing || isRefreshing) return;\n\n    if ((isProtectedRoute || isHomePageProtected) && !isAuthenticated) {\n      router.replace(\"/login\");\n      return;\n    }\n\n    if (isAuthenticated && isPublicRoute) {\n      router.replace(\"/\");\n      return;\n    }\n  }, [\n    isAuthenticated,\n    isRefreshing,\n    isInitializing,\n    pathname,\n    isProtectedRoute,\n    isHomePageProtected,\n    isPublicRoute,\n    router,\n  ]);\n\n  // Always block rendering until auth state is ready\n  if (isInitializing) {\n    return (\n      <div className=\"flex h-screen w-full items-center justify-center bg-black\">\n        <Loading customStyle=\"h-12 w-12 border-gray-400\" customBg=\"bg-black\" />\n      </div>\n    );\n  }\n\n  if ((isProtectedRoute || isHomePageProtected) && !isAuthenticated) {\n    return null;\n  }\n\n  return <>{children}</>;\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAUA,6CAA6C;AAC7C,MAAM,mBAAmB;IAAC;IAAW;IAAU;IAAU;CAAS;AAClE,MAAM,gBAAgB;IAAC;IAAU;CAAY;AAEtC,SAAS,WAAW,EAAE,QAAQ,EAAmB;IACtD,MAAM,EAAE,eAAe,EAAE,YAAY,EAAE,cAAc,EAAE,GAAG,IAAA,2HAAO;IACjE,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,iJAAW,OAAM;IAElC,kCAAkC;IAClC,MAAM,gBAAgB,cAAc,IAAI,CAAC,CAAC,QACxC,SAAS,UAAU,CAAC;IAGtB,qCAAqC;IACrC,MAAM,mBAAmB,iBAAiB,IAAI,CAAC,CAAC,QAC9C,SAAS,UAAU,CAAC;IAGtB,kDAAkD;IAClD,MAAM,sBAAsB,aAAa,OAAO,CAAC;IAEjD,iBAAiB;IACjB,IAAA,kNAAS,EAAC;QACR,IAAI,kBAAkB,cAAc;QAEpC,IAAI,CAAC,oBAAoB,mBAAmB,KAAK,CAAC,iBAAiB;YACjE,OAAO,OAAO,CAAC;YACf;QACF;QAEA,IAAI,mBAAmB,eAAe;YACpC,OAAO,OAAO,CAAC;YACf;QACF;IACF,GAAG;QACD;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,mDAAmD;IACnD,IAAI,gBAAgB;QAClB,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC,8IAAO;gBAAC,aAAY;gBAA4B,UAAS;;;;;;;;;;;IAGhE;IAEA,IAAI,CAAC,oBAAoB,mBAAmB,KAAK,CAAC,iBAAiB;QACjE,OAAO;IACT;IAEA,qBAAO;kBAAG;;AACZ","debugId":null}}]
}